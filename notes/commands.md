# Docker commands

## -- expose ports in Docker

`-p 127.0.0.1:host-port:container-port`


## -- mount container volumes to host filesystem

`-v /host/path:/container/path`


## -- mount volumes

`-v volume_name:/container/path`


## -- create network namespace

namespace name generated by docker (usually ugly, uninformative and contains random hash):

`docker network create --subnet=172.18.0.0/16 ns-name`

namespace name set manually (no more ugly `ip a` output and actually manageable):

`docker network create --subnet=172.18.0.0/16 -o "com.docker.network.bridge.name"="ns-name" ns-name`


## -- custom network with static IP address

`--net ns-name --ip subnet-ip`


## -- transfer data between volumes and/or host filesystem

```sh
docker volume create new_name
docker run --rm -it -v random_long_hash:/from -v new_name:/to alpine ash -c "cd /from ; cp -av . /to"
docker volume rm random_long_hash
```


## -- garbage collect registry

`docker exec docker-registry /bin/registry garbage-collect /etc/docker/registry/config.yml`


## -- Docker in Docker

`docker run --privileged -d --name namespace-name docker:dind`


## -- VMware Tools in CoreOS

`docker run -d --net=host --privileged --name vmware-tools corfr/vmware-tools:latest`


## -- Arch Linux container sandbox

keep container for later:

```sh
docker run --name archlinux -td archlinux/base:latest
docker exec -it archlinux /bin/bash
```

remove container after exit:

```sh
docker run --rm -it --name archlinux-sandbox archlinux/base:latest /bin/bash
```


## -- overwrite default entry point during run

```sh
docker run --rm -it --entrypoint=/bin/sh imagename:tag
```

This can be useful for debugging an image or when you need to run other commands
inside the image, but the default entry point forbids running other commands
(example: Matrix Synapse to migrate the SQLite database to PostgreSQL).
